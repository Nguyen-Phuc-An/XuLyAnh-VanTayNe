CHƯƠNG 5. MINH HỌA / MÔ PHỎNG HỆ THỐNG

5.1 Mô hình tổng quát của hệ thống nhận dạng vân tay

Hệ thống nhận dạng vân tay được thiết kế theo mô hình ba tầng để đảm bảo tính module hóa, dễ bảo trì và mở rộng. Tầng đầu tiên là tầng giao diện người dùng, được xây dựng bằng Tkinter, cho phép người dùng tương tác với hệ thống thông qua các chức năng như xử lý ảnh, tìm kiếm người dùng và đăng ký tài khoản mới. Tầng thứ hai là tầng xử lý và phân tích đặc trưng, nơi thực hiện các bước tiền xử lý ảnh (chuyển sang grayscale, chuẩn hóa, lọc nhiễu), nhị phân hóa và làm mảnh, trích chọn đặc trưng bằng 5 phương pháp khác nhau, và cuối cùng là so khớp vân tay. Tầng thứ ba là tầng lưu trữ và cơ sở dữ liệu, sử dụng MySQL để lưu trữ thông tin người dùng, vân tay, và lịch sử so khớp.

Hệ thống bao gồm năm module chính. Module tiền xử lý ảnh có trách nhiệm chuyển đổi ảnh từ RGB sang grayscale để giảm kích thước dữ liệu, chuẩn hóa ảnh bằng phương pháp CLAHE để cân bằng độ tương phản, lọc nhiễu bằng Bilateral Filter để bảo toàn cạnh trong khi làm mịn, và tăng cường ảnh bằng Gabor Filter để làm nổi bật các sọc vân tay. Module nhị phân hóa sử dụng phương pháp Otsu để tự động xác định ngưỡng, tạo ảnh nhị phân với chỉ hai giá trị 0 và 1, và loại bỏ nhiễu nhỏ bằng các phép toán hình thái học. Module làm mảnh ảnh áp dụng thuật toán Zhang-Suen để giảm chiều rộng các sọc vân tay xuống 1 pixel, loại bỏ các đường nhỏ lẻ có độ dài nhỏ hơn 3 pixels, và tạo ra bộ khung (skeleton) của vân tay.

Module trích chọn đặc trưng sử dụng năm phương pháp khác nhau. Phương pháp Minutiae (chi tiết vân tay) phát hiện các điểm kết thúc (ending) và ngã ba (bifurcation) thông qua thuật toán Crossing Number, sau đó tính toán hướng tại mỗi điểm. Phương pháp LBP (Local Binary Pattern) phân tích kết cấu cục bộ của ảnh bằng cách so sánh giá trị của mỗi pixel với các hàng xóm của nó, từ đó tạo ra một mẫu nhị phân độc đáo. Phương pháp Ridge Orientation Field tính toán hướng sọc tại mỗi vùng của ảnh bằng phương pháp gradient, và phân tích tính nhất quán của các hướng này. Phương pháp Frequency Domain Analysis áp dụng biến đổi Fourier nhanh (FFT) để phân tích tần số sọc và các đặc tính năng lượng. Cuối cùng, phương pháp Feature Matching sử dụng các bộ phát hiện đặc trưng như SIFT hoặc ORB để phát hiện các điểm đặc trưng và so sánh chúng bằng KNN matching với Lowe's ratio test.

Module so khớp vân tay sử dụng năm phương pháp để tính toán độ tương đồng giữa hai vân tay. Phương pháp Minutiae Matching so khớp các điểm chi tiết có độ chính xác cao nhưng yêu cầu ảnh chất lượng tốt. Phương pháp Feature Matching nhanh và linh hoạt nhưng có thể bị lỗi với ảnh mờ. Phương pháp LBP Texture so sánh histogram LBP và thích ứng tốt với biến dạng nhưng nhạy cảm với thay đổi độ sáng. Phương pháp Ridge Orientation so sánh các trường hướng sọc và ít phụ thuộc vào chất lượng ảnh nhưng yêu cầu độ phân giải đủ. Phương pháp Frequency Domain phân tích tần số và bao quát được toàn bộ ảnh nhưng có độ phức tạp tính toán cao.



5.2 Mô tả quy trình xử lý ảnh và xác thực

Quy trình xử lý ảnh bao gồm mười bước chính. Bước thứ nhất là chuyển đổi ảnh từ RGB sang grayscale bằng công thức Y = 0.299R + 0.587G + 0.114B. Đầu vào là ảnh vân tay nguyên gốc có ba kênh màu (Red, Green, Blue), đầu ra là ảnh xám có một kênh màu với giá trị từ 0 đến 255. Bước thứ hai là chuẩn hóa ảnh sử dụng phương pháp CLAHE (Contrast Limited Adaptive Histogram Equalization) với tham số clipLimit = 2.0 và tileGridSize = (8,8). Quá trình này cân bằng độ tương phản cục bộ để làm rõ các chi tiết nhỏ mà không làm tăng quá mức nhiễu.

Bước thứ ba là lọc nhiễu bằng Bilateral Filter với tham số diameter = 9, sigma_color = 75, sigma_space = 75. Phương pháp này làm mịn ảnh trong khi bảo toàn các cạnh quan trọng của các sọc vân tay, điều này rất quan trọng để giảm nhiễu nhưng không mất thông tin. Bước thứ tư là tăng cường ảnh bằng Gabor Filter với 6 hướng khác nhau (0°, 30°, 60°, 90°, 120°, 150°). Các bộ lọc Gabor được áp dụng để làm nổi bật các sọc vân tay theo các hướng khác nhau, từ đó cải thiện khả năng phát hiện đặc trưng.

Bước thứ năm là nhị phân hóa ảnh sử dụng phương pháp Otsu, một kỹ thuật thống kê tìm ngưỡng tối ưu để chia ảnh thành hai mức (đen và trắng). Phương pháp này tối đa hóa phương sai giữa các lớp, đảm bảo rằng các vân tay được tách biệt rõ ràng khỏi nền. Bước thứ sáu là làm mảnh ảnh sử dụng thuật toán Zhang-Suen, một quy trình lặp lại loại bỏ từng pixel dựa trên các quy tắc nhất định. Kết quả là các sọc vân tay có độ rộng chỉ 1 pixel, và các đường nhỏ lẻ (có độ dài nhỏ hơn 3 pixels) được loại bỏ.

Bước thứ bảy là trích chọn đặc trưng sử dụng năm phương pháp khác nhau. Phương pháp Minutiae Detection sử dụng Crossing Number để phát hiện điểm kết thúc (CN=1) và ngã ba (CN=3). Phương pháp LBP Features tính toán mẫu nhị phân cục bộ tại mỗi pixel. Phương pháp Ridge Orientation Field tính toán hướng sọc bằng phương pháp gradient. Phương pháp Frequency Domain Analysis sử dụng FFT để trích tần số sọc. Cuối cùng, phương pháp Feature Matching sử dụng SIFT hoặc ORB để phát hiện keypoints và descriptors.

Bước thứ tám là so khớp vân tay. Từ hai tập đặc trưng trích được từ hai ảnh, hệ thống tính toán độ tương đồng theo năm phương pháp khác nhau. Các công thức tính điểm sử dụng exponential decay để đảm bảo rằng chỉ những vân tay thực sự giống nhau mới nhận được điểm cao. Bước thứ chín là kiểm tra tính nhất quán. Nếu phát hiện được trường hợp "Khớp < 10% nhưng Tương đồng > 70%", hệ thống sẽ tự động hiển thị cảnh báo màu cam, thông báo cho người dùng rằng hai ảnh có cơ cấu tương tự nhưng có thể là của hai người khác nhau.

Bước thứ mười là lưu trữ kết quả. Chi tiết so khớp được lưu vào file text trong thư mục ket_qua/, cơ sở dữ liệu được cập nhật bảng matching_history, và các ảnh trung gian được lưu nếu cần thiết. Kết quả cuối cùng bao gồm tỉ lệ khớp tính bằng phần trăm, điểm tương đồng từ 0 đến 100, và các nhận xét về độ tin cậy của kết quả.

Công thức tính điểm tương đồng khác nhau cho mỗi phương pháp. Với Minutiae Matching, công thức là score = (matched_points / min(total_points1, total_points2)) × 100, trong đó matched_points là số điểm minutiae khớp với khoảng cách nhỏ hơn 50 pixels và hướng khác nhau nhỏ hơn 30 độ. Với Feature Matching, công thức là score = (good_matches / total_keypoints) × 100, trong đó good_matches là số điểm khớp qua Lowe's ratio test với ngưỡng 0.7. Với LBP Texture, công thức sử dụng exponential decay: score = 100 × exp(-chi_square / 2), trong đó chi_square là khoảng cách chi-square giữa hai histogram LBP. Công thức này đảm bảo rằng điểm cao chỉ được cấp khi chi_square rất nhỏ.

Với Ridge Orientation, công thức cũng sử dụng exponential decay: score = 100 × exp(-mean_angle_diff / 45), trong đó mean_angle_diff là trung bình các góc khác nhau giữa hai trường hướng. Với Frequency Domain, công thức kết hợp ba thành phần: score = 100 × exp(-(freq_diff² + energy_diff² + ridge_diff²) / 2), đảm bảo rằng điểm cao chỉ được cấp khi tất cả ba thành phần (tần số sọc, năng lượng, và đặc tính ridge) đều tương đồng.

Quy trình xác thực người dùng có hai phần. Phần tìm kiếm (Identification) bắt đầu khi người dùng nhập ảnh vân tay. Hệ thống sẽ xử lý ảnh qua các bước 1 đến 7, trích chọn đặc trưng bằng năm phương pháp, sau đó so khớp với tất cả vân tay trong cơ sở dữ liệu. Các điểm so khớp được sắp xếp theo thứ tự giảm dần. Nếu điểm cao nhất lớn hơn ngưỡng (thường từ 50% đến 70%), hệ thống sẽ hiển thị thông tin của người dùng được tìm thấy. Nếu không, hệ thống sẽ thông báo rằng không tìm thấy người dùng. Cuối cùng, lịch sử tìm kiếm được lưu vào cơ sở dữ liệu.

Phần đăng ký (Enrollment) bắt đầu khi người dùng mới muốn tham gia hệ thống. Người dùng nhập thông tin cá nhân bao gồm username, họ tên, email, số điện thoại, CCCD, chức vụ, và phòng ban. Tiếp theo, người dùng chọn ảnh vân tay và hệ thống sẽ xử lý ảnh, trích chọn đặc trưng, và tính toán quality_score dựa trên số lượng minutiae phát hiện, sự phân bố của minutiae, và độ tương phản của ảnh. Nếu quality_score thấp hơn 40%, hệ thống sẽ yêu cầu người dùng chụp lại ảnh. Nếu chất lượng chấp nhận được, thông tin người dùng và vân tay sẽ được lưu vào cơ sở dữ liệu với trạng thái 'approved', 'pending', hoặc 'rejected' tùy theo chất lượng ảnh, và hệ thống sẽ thông báo đăng ký thành công.



5.3 Kết quả minh họa và nhận xét

Hệ thống đã được kiểm tra trên một bộ dữ liệu gồm 200 ảnh từ 50 người (mỗi người 4 ảnh), với tỉ lệ 50% cặp ảnh cùng vân tay và 50% cặp ảnh khác nhân vân. Kết quả kiểm tra cho thấy hệ thống đạt độ chính xác toàn thể là 93.0%, với độ nhạy (sensitivity) là 92.0% và độ đặc hiệu (specificity) là 94.0%. Ma trận nhầm lẫn cho thấy hệ thống phát hiện đúng 92 cặp ảnh cùng vân tay (true positives), nhưng cũng có 8 cặp bị bỏ sót (false negatives). Ngoài ra, hệ thống phát hiện sai 6 cặp ảnh khác nhân vân (false positives) nhưng đúng 94 cặp (true negatives). Precision của hệ thống là 93.9%, có nghĩa là 93.9% những khoảnh khắc hệ thống cảnh báo khớp là chính xác. F1-Score là 92.9%, cho thấy sự cân bằng tốt giữa độ nhạy và precision.

Khi kiểm tra từng phương pháp riêng lẻ, Minutiae Matching đạt hiệu suất cao nhất với độ chính xác 94.5%, F1-Score 93.8%, và AUC 0.96. Điều này chứng tỏ rằng phương pháp dựa trên các điểm chi tiết của vân tay là rất hiệu quả. Feature Matching đạt độ chính xác 87.0% và AUC 0.89. LBP Texture đạt 85.3% và AUC 0.87. Ridge Orientation đạt 88.5% và AUC 0.90. Frequency Domain đạt 83.2% và AUC 0.85. Khi kết hợp tất cả năm phương pháp lại, hệ thống đạt độ chính xác 93.0% và F1-Score 92.9%, chỉ thấp hơn Minutiae Matching một chút nhưng cao hơn rất nhiều so với các phương pháp khác. Điều này cho thấy rằng việc kết hợp nhiều phương pháp có thể cải thiện sự tin cậy của hệ thống thông qua sự bổ sung cho nhau.

Phân tích thời gian xử lý cho ảnh 500x500 pixel cho thấy tổng thời gian là khoảng 663 milliseconds. Trong đó, bước trích chọn đặc trưng chiếm 365.8ms (55.2%), chủ yếu là do tính toán Gabor Filter (85.3ms, 12.9%). Bước so khớp chiếm 98.4ms (14.8%). Bước làm mảnh chiếm 42.7ms (6.4%). Các bước còn lại chiếm thời gian ít hơn. Thời gian xử lý này chấp nhận được cho hầu hết các ứng dụng thực tế. Tuy nhiên, khi cần so khớp một ảnh với 100 vân tay trong cơ sở dữ liệu, thời gian tổng cộng sẽ là khoảng 9.8 giây, điều này có thể chấp nhận được cho các hệ thống off-line nhưng có thể quá chậm cho các ứng dụng yêu cầu xử lý real-time trên một lượng lớn dữ liệu.

Hệ thống có những điểm mạnh đáng chú ý. Thứ nhất, độ chính xác cao (93%) cho phép hệ thống phân biệt tốt giữa các vân tay khác nhau, đáp ứng được yêu cầu của các ứng dụng bảo mật. Thứ hai, hệ thống cảnh báo thông minh phát hiện được trường hợp "khớp thấp nhưng tương đồng cao", giúp người dùng nhận biết những tình huống đặc biệt và yêu cầu kiểm tra thêm. Thứ ba, việc sử dụng năm phương pháp khác nhau giúp tăng độ tin cậy của hệ thống, vì các phương pháp bổ sung cho nhau: Minutiae Matching tập trung vào các điểm chi tiết, LBP tập trung vào kết cấu cục bộ, Ridge Orientation tập trung vào hướng sọc, và Frequency Domain tập trung vào các đặc tính toàn cầu. Thứ tư, thời gian xử lý khoảng 0.66 giây cho một ảnh là chấp nhận được cho hầu hết các ứng dụng thực tế.

Tuy nhiên, hệ thống cũng có những điểm yếu cần được cải thiện. Thứ nhất, hệ thống phụ thuộc rất nhiều vào chất lượng ảnh đầu vào. Ảnh mờ, không rõ ràng, hoặc chụp từ một góc không tốt sẽ làm giảm hiệu suất của hệ thống. Yêu cầu ảnh có độ phân giải tối thiểu 300x300 pixel hoặc cao hơn để đạt được kết quả tốt nhất. Thứ hai, độ phức tạp tính toán cao, đặc biệt là ở bước Gabor Filter (chiếm 12.9% thời gian xử lý) và bước trích chọn đặc trưng (chiếm 55.2% thời gian). Điều này không phù hợp cho các ứng dụng yêu cầu xử lý real-time trên các thiết bị yếu như smartphone cũ hoặc embedded systems. Thứ ba, hệ thống nhạy cảm với góc chụp của ảnh. Ảnh chụp không vuông góc hoặc bị xoay sẽ cho kết quả kém hơn, do đó cần hướng dẫn người dùng về cách chụp ảnh đúng cách. Thứ tư, với số lượng vân tay lớn trong cơ sở dữ liệu (ví dụ 10,000 vân tay), thời gian so khớp sẽ tăng tuyến tính, có thể lên đến 98 giây mỗi lần tìm kiếm, điều này không thực tế.

Để cải thiện hệ thống trong tương lai, có thể áp dụng các giải pháp sau. Thứ nhất, tối ưu hóa hiệu suất bằng cách sử dụng GPU acceleration cho các phép toán ma trận (Gabor Filter, FFT, so khớp đặc trưng), điều này có thể tăng tốc độ gấp 10 lần hoặc hơn. Thứ hai, cải thiện xử lý ảnh bằng cách thêm chuẩn hóa góc chụp (tự động phát hiện và xoay ảnh), chuẩn hóa kích thước vân tay (phát hiện và chuẩn hóa vùng vân tay), và lọc ảnh có chất lượng thấp (từ chối ảnh có chất lượng dưới một ngưỡng nhất định). Thứ ba, mở rộng hệ thống hỗ trợ đa toa chạm, cho phép lưu trữ vân tay của cả 10 ngón tay (Thumb, Index, Middle, Ring, Pinky) trên cả hai tay, điều này sẽ tăng đáng kể độ tin cậy nhận dạng. Thứ tư, sử dụng Machine Learning, đặc biệt là Convolutional Neural Networks (CNN), để trích chọn đặc trưng tự động từ dữ liệu, thay vì sử dụng các phương pháp trích chọn đặc trưng tay chân. Điều này có thể dẫn đến hiệu suất cao hơn và khả năng tổng quát hóa tốt hơn.

Tóm lại, hệ thống nhận dạng vân tay đã được xây dựng và kiểm tra thành công với các kết quả tích cực. Hệ thống đạt độ chính xác 93% trên bộ dữ liệu kiểm tra, thời gian xử lý khoảng 0.66 giây mỗi ảnh, và có giao diện người dùng thân thiện. Hệ thống phù hợp cho các ứng dụng như quản lý chấm công, kiểm soát truy cập vào các khu vực an ninh, và xác thực người dùng trong các hệ thống ngân hàng hoặc y tế. Mặc dù vẫn còn những điểm yếu cần cải thiện, nhưng với các điểm mạnh hiện tại, hệ thống này có tiềm năng lớn để trở thành một công cụ bảo mật biometric mạnh mẽ và đáng tin cậy.
